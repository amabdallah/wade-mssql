USE [WaDE_Oct2014]
GO

/****** Object:  View [wade_r].[DETAIL_LOCATION]    Script Date: 8/15/2016 11:41:21 AM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



-- View: "WADE_R"."DETAIL_LOCATION"

-- DROP VIEW "WADE_R"."DETAIL_LOCATION";

CREATE VIEW [wade_r].[DETAIL_LOCATION] AS 
        (((SELECT DISTINCT a."ORGANIZATION_ID", 
        a."REPORT_ID", 
        a."ALLOCATION_ID", 
        'DETAIL' AS "DATACATEGORY", 
        'ALLOCATION' AS "DATATYPE", 
        b."STATE", 
        b."REPORTING_UNIT_ID", 
        b."COUNTY_FIPS", 
        b."HUC"
        
        FROM "WADE"."DETAIL_ALLOCATION" 
        a JOIN "WADE"."D_ALLOCATION_LOCATION" b ON a."ORGANIZATION_ID" = b."ORGANIZATION_ID" 
        AND a."REPORT_ID" = b."REPORT_ID" 
        AND a."ALLOCATION_ID" = b."ALLOCATION_ID"
           
        WHERE b.REPORTING_UNIT_ID IS NOT NULL OR 
        b.COUNTY_FIPS IS NOT NULL OR b.HUC IS NOT NULL)
        
        UNION 
        
        SELECT DISTINCT "DETAIL_DIVERSION"."ORGANIZATION_ID",
        "DETAIL_DIVERSION"."REPORT_ID",
        "DETAIL_DIVERSION"."ALLOCATION_ID",
        'DETAIL' AS "DATACATEGORY",
        'DIVERSION' AS "DATATYPE", 
        "DETAIL_DIVERSION"."STATE", 
        "DETAIL_DIVERSION"."REPORTING_UNIT_ID", 
        "DETAIL_DIVERSION"."COUNTY_FIPS", 
        "DETAIL_DIVERSION"."HUC"
        FROM "WADE"."DETAIL_DIVERSION" 
        WHERE "DETAIL_DIVERSION"."REPORTING_UNIT_ID" IS NOT NULL 
        OR "DETAIL_DIVERSION"."COUNTY_FIPS" IS NOT NULL 
        OR "DETAIL_DIVERSION"."HUC" IS NOT NULL)
           
           UNION SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", a."ALLOCATION_ID", 'DETAIL' AS "DATACATEGORY", 'USE' AS "DATATYPE", b."STATE", b."REPORTING_UNIT_ID", b."COUNTY_FIPS", b."HUC"
           FROM "WADE"."DETAIL_USE" a JOIN "WADE"."D_USE_LOCATION" b ON a."ORGANIZATION_ID" = b."ORGANIZATION_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ALLOCATION_ID" = b."ALLOCATION_ID"
           WHERE b.REPORTING_UNIT_ID IS NOT NULL OR b.COUNTY_FIPS IS NOT NULL OR b.HUC IS NOT NULL)
           
           UNION SELECT DISTINCT "DETAIL_RETURN_FLOW"."ORGANIZATION_ID", "DETAIL_RETURN_FLOW"."REPORT_ID", "DETAIL_RETURN_FLOW"."ALLOCATION_ID", 'DETAIL' AS "DATACATEGORY", 'RETURN' AS "DATATYPE", "DETAIL_RETURN_FLOW"."STATE", "DETAIL_RETURN_FLOW"."REPORTING_UNIT_ID", "DETAIL_RETURN_FLOW"."COUNTY_FIPS", "DETAIL_RETURN_FLOW"."HUC"
           FROM "WADE"."DETAIL_RETURN_FLOW" WHERE "DETAIL_RETURN_FLOW"."REPORTING_UNIT_ID" IS NOT NULL OR "DETAIL_RETURN_FLOW"."COUNTY_FIPS" IS NOT NULL OR "DETAIL_RETURN_FLOW"."HUC" IS NOT NULL;



GO


