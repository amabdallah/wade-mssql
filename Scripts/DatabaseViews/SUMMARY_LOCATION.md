USE [WaDE_Oct2014]
GO

/****** Object:  View [wade_r].[SUMMARY_LOCATION]    Script Date: 8/15/2016 11:41:41 AM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



-- View: "WADE_R"."SUMMARY_LOCATION"

-- DROP VIEW "WADE_R"."SUMMARY_LOCATION";

CREATE VIEW [wade_r].[SUMMARY_LOCATION] AS 
        (((SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", '' AS "ALLOCATION_ID",
         'SUMMARY' AS "DATACATEGORY",
         'ALLOCATION' AS "DATATYPE", b."STATE", b."REPORT_UNIT_ID", b."COUNTY_FIPS", b."HUC"
                                   
          FROM "WADE"."SUMMARY_ALLOCATION" a
          JOIN "WADE"."REPORTING_UNIT" b ON a."REPORT_UNIT_ID" = b."REPORT_UNIT_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ORGANIZATION_ID" = b."ORGANIZATION_ID"
          
          UNION 
                 
          SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", '' AS "ALLOCATION_ID", 
          'SUMMARY' AS "DATACATEGORY", 
          'AVAILABILITY' AS "DATATYPE", b."STATE", b."REPORT_UNIT_ID", b."COUNTY_FIPS", b."HUC"
          FROM "WADE"."SUMMARY_AVAILABILITY" a
          JOIN "WADE"."REPORTING_UNIT" b ON a."REPORT_UNIT_ID" = b."REPORT_UNIT_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ORGANIZATION_ID" = b."ORGANIZATION_ID")
          
          UNION 
          
          SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", '' AS "ALLOCATION_ID", 
          'SUMMARY' AS "DATACATEGORY", 
          'REGULATORY' AS "DATATYPE", b."STATE", b."REPORT_UNIT_ID", b."COUNTY_FIPS", b."HUC"
          FROM "WADE"."SUMMARY_REGULATORY" a
          JOIN "WADE"."REPORTING_UNIT" b ON a."REPORT_UNIT_ID" = b."REPORT_UNIT_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ORGANIZATION_ID" = b."ORGANIZATION_ID")
          
		  UNION 
                 
          SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", '' AS "ALLOCATION_ID", 
          'SUMMARY' AS "DATACATEGORY", 
          'USE' AS "DATATYPE", b."STATE", b."REPORT_UNIT_ID", b."COUNTY_FIPS", b."HUC"
          FROM "WADE"."SUMMARY_USE" a
          JOIN "WADE"."REPORTING_UNIT" b ON a."REPORT_UNIT_ID" = b."REPORT_UNIT_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ORGANIZATION_ID" = b."ORGANIZATION_ID")
          
		  UNION 

          SELECT DISTINCT a."ORGANIZATION_ID", a."REPORT_ID", '' AS "ALLOCATION_ID", 
          'SUMMARY' AS "DATACATEGORY", 
          'SUPPLY' AS "DATATYPE", b."STATE", b."REPORT_UNIT_ID", b."COUNTY_FIPS", b."HUC"
          FROM "WADE"."SUMMARY_WATER_SUPPLY" a
          JOIN "WADE"."REPORTING_UNIT" b ON a."REPORT_UNIT_ID" = b."REPORT_UNIT_ID" AND a."REPORT_ID" = b."REPORT_ID" AND a."ORGANIZATION_ID" = b."ORGANIZATION_ID";





GO


